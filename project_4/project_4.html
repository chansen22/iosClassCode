<!DOCTYPE html>
<!-- saved from url=(0059)http://www.ecst.csuchico.edu/~chmorris/csci567/projects/04/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <title>ChartToppers II</title>
  
  <link rel="stylesheet" type="text/css" href="./project_4_files/reset-min.css">    
  <link rel="stylesheet" type="text/css" href="./project_4_files/default.css">    
  <link rel="stylesheet" type="text/css" href="./project_4_files/project.css">
<style type="text/css"></style></head>
<body class=" hasGoogleVoiceExt">

  <div id="content-area">
    <h1><span id="course-number">Project 4</span><span id="course-name">ChartToppers II</span></h1>
  
    <div id="due">
      <h2>Due Date</h2>
      <p>
        Friday, April 12, 2013 by 11:59pm
      </p>
    </div>

    <h2 id="objectives">Objectives</h2>
<ul>
  <li>Continued experience with MVC</li>
  <li>Gain experience working with asynchronous operations</li>
  <li>Gain experience working with the network activity viewer</li>
  <li>Gain experience working with <code>UIActivityIndicatorView</code></li>
  <li>Further work with the <code>UITableViewController</code></li>
</ul>

<h2 id="description">Description</h2>
<p>In this project, you will enhance your previous <a href="http://www.ecst.csuchico.edu/~chmorris/csci567/projects/03/">ChartToppers Project</a>
by making it more “App Store Ready”.  The primary focus of this project is to move all of the
network activity to a background thread.  In addition, there are some user interface
enhancements which are all done in an effort to make the user experience more polished.</p>

<p>This project assumes that you have a working Project 3.  While you will primarily be evaluated
on the new aspects that are introduced in this project, a non-functioning or semi-functioning
Project 3 may be problematic.  If you do not have a functional Project 3, you will need to see me.</p>

<p>Before starting this project, <strong>you MUST copy your entire Project 3 into a new
<code>project_4</code> directory</strong>.  You will be working with this copy and will not make
any modifications to your original project.</p>

<h2 id="network-data">Network Data</h2>

<h3 id="forced-delay">Forced Delay</h3>
<p>All requests for network resources must be preceded by the following line of code:</p>

<pre><code>[NSThread sleepForTimeInterval:drand48() * 3.0];
</code></pre>

<p>Failure to include this line will be an indication that you do not know when your
app is actually accessing the network, and when it is working with local resources.</p>

<p>In any further discussion of network activity in this project description, assume 
that this line, along with the line following it, which is actually accessing the
network, are both considered network activity.</p>

<p>This line would never be included in a released app, but for your project it is required.
It will actually make the project easier to test and debug because it is forcing the
network to have some perceived latency.  This way you will really know if your
activities are happening on the main thread or a background thread.</p>

<h3 id="asynchronous-network-access">Asynchronous Network Access</h3>
<p>All network activity, inclusive of the forced delay, must be performed on a background
thread using Grand Central Dispatch (GCD).  Your main thread will not block as it did in
the previous project.</p>

<p>This means that your app will launch immediately, and display the results once it has
loaded them.  The results will be displayed in a <code>UITableView</code> as was done previously,
but now they will also include the artwork for the media item in the row.  The
artwork will be loaded asynchronously as well, meaning that initially it will be missing,
and once it is loaded, it will appear.</p>

<p>If you would like to use a concurrent queue instead of a serial queue for the image loading
you are encouraged, but not required to do so.</p>

<p><strong>The asynchronous operations will appear in the controllers, and not the models.</strong>  This means
that your models/helpers–<code>ITunesFetcher</code> and <code>ITunesMediaItem</code>–will continue to offer blocking
calls.  It will be your controller that will dispatch the blocking calls to a
background queue.</p>

<p>There are at least three obvious places where this will happen–two places in the 
<code>ITunesMediaItemsTableVieController</code> and one in the <code>ITunesMediaItemDetailViewController</code>.
(HINT: What happens when you tap an item that has not loaded the image yet?)</p>

<h2 id="controllers">Controllers</h2>

<p>I would encourage you to clean up your view controllers that extend the <code>ITunesMediaItemsTableViewController</code>
so that there is as little duplication as possible.  Ideally, the dispatching to a background
thread would happen in the super class, and not in each sub class.</p>

<h2 id="the-user-interface">The User Interface</h2>

<p>The following changes will be made to the user interface.</p>

<h3 id="images-in-the-list-view">Images in the list view</h3>
<p>When you are listing the <code>ITunesMediaItem</code>s, you will now include the artwork associated
with each item.  In the case that the artwork is not available, you can decide how to handle
the behavior.</p>

<p>I would encourage you to really consider what <code>contentMode</code> will work best for images at
such a small size.  You will see in the following two examples which I felt was most
appropriate.  You might find the option to clip subviews helpful in Xcode.</p>

<p><img src="./project_4_files/artwork.png" alt="Artwork in Rows">
<img src="./project_4_files/artwork2.png" alt="Artwork for Movies"></p>

<p>When updating the images in the cells, you will want to use the <code>UITableView</code> method
<code>cellForRowAtIndexPath:</code> otherwise, you might get surprising results.</p>

<p>NOTE: You will <strong>only load images as needed</strong> and not preload all of the images.  This means
that as you scroll through the list, only when a row is displayed will the image be fetched.</p>

<p>NOTE: You will hopefully realize that it is very possible that there could be multiple requests
for the artwork image from the model.  While it is not required, you could consider using
a <code>@synchronized</code> call here.</p>

<h3 id="uiactivityindicatorview">UIActivityIndicatorView</h3>
<p>While your app is waiting for images to load, a <code>UIActivityIndicatorView</code> will be shown.
Once the image has loaded, the <code>UIActivityIndicatorView</code> will disappear.</p>

<p><img src="./project_4_files/activity.png" alt="Activity in Rows">
<img src="./project_4_files/activity2.png" alt="Activity in Detail"></p>

<h3 id="item-summary">Item Summary</h3>
<p>In the detail view, you will now display the summary information about the <code>ITunesMediaItem</code>.
This will mean that if you have not already extracted this information from the initial JSON
payload, you will need to adjust your model to track the summary.</p>

<p>The difficulty with displaying this data is that the size of the cell and <code>UITextView</code> will need
to change depending on the amount of text needed to display.  In order to solve this, I encourage
you to investigate the <code>contentSize</code> property on the <code>UITextView</code> as well as the <code>UITableViewDelegate</code>
method <code>tableView:heightForRowAtIndexPath:</code>.</p>

<p><img src="./project_4_files/summary.png" alt="Summary View">
<img src="./project_4_files/summary2.png" alt="Summary View"></p>

<p>NOTE: I did notice that some items do not have descriptions.  You can decide what to do in those cases.
In addition, I also noticed that some of the items have embedded HTML.  For this project, it is
fine to just display the HTML as plain text (as is).  If you want to experiment with a <code>UIWebView</code>,
you can.</p>

<h3 id="pull-to-refresh">Pull To Refresh</h3>
<p>Your <code>ITunesMediaItemsTableViewController</code> will support the pull-to-refresh behavior.  This means
that upon after the list has been refreshed, the images will also need to be refreshed.  If you
need help on how to implement this, consult <a href="https://itunes.apple.com/us/course/11.-multithreading-persistence/id593208016?i=134256549&mt=2">Lecture 11</a>.</p>

<p><img src="./project_4_files/refresh.png" alt="Refresh"></p>

<h3 id="network-activity-indicator">Network Activity Indicator</h3>
<p>All access to the network, inclusive of our forced delay, must be indicated via the 
network activity indicator.</p>

<p><img src="./project_4_files/network_activity.png" alt="Network Activity"></p>

<p>As we have discussed, the API for this is too simple, which leads to some
potential complications.  You will need to write a helper class that knows how and when to display
and hide the network activity indicator.  This class should implement the Singleton Design Pattern.</p>

<p>This means that all network calls must be surrounded by a call to your utility class to start/stop the
monitor.</p>

<p>The public interface to my class is as follows:</p>

<pre><code>#import &lt;Foundation/Foundation.h&gt;

@interface NetworkActivityTracker : NSObject

+ (NetworkActivityTracker *)sharedInstance;

- (void)showActivityIndicator;
- (void)hideActivityIndicator;

@end
</code></pre>

<p>The Singleton Design pattern can be implemented as follows:</p>

<pre><code>+ (NetworkActivityTracker *)sharedInstance
{
    static NetworkActivityTracker *sharedInstance;
    
    static dispatch_once_t onceToken;
    dispatch_once(&amp;onceToken, ^{
        sharedInstance = [[NetworkActivityTracker alloc] init];
    });
    
    return sharedInstance;
}
</code></pre>

<h3 id="app-icon--retina-graphics">App Icon &amp; Retina Graphics</h3>
<p>You must include an app icon for this project.  The icon must be provided for both
retina and non-retina iPhones (57x57 and 114x114).</p>

<p>In addition, your tab bar must have icons for each tab, and each icon must have
a retina and non-retina version.  This means that if you have an icon of size
35x35 called apps.png, you will also have a higher resolution version of the
same icon at the size 70x70 called apps@2x.png.</p>

<h3 id="polish">Polish</h3>
<p>Do your best to make your app look nice.  Consider trying to make it look unique
(while still meeting all of the requirements).</p>

<h2 id="deliverables">Deliverables</h2>
<p>By the due date/time you are expected to have committed your working Xcode
project to your private github repository for CSCI 567 at the location 
<code>/project_4/ChartToppers</code>.  As always, this project is to be done individually.</p>

    
  </div>



</body></html>